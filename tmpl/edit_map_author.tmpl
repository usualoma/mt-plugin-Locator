<fieldset>
<h3><MT_TRANS phrase="Map"></h3>

<mtapp:setting
	id="location_address"
	label="<__trans phrase="Address">"
	hint="<__trans phrase="The address of the site associated with .">">
	<input name="location_address" id="location_address" class="half-width" value="<mt:var name="location_address" escape="html">" />
</mtapp:setting>

<mtapp:setting
	id="location_map"
	label="<__trans phrase="Map">"
	hint="<__trans phrase="The location of the site associated with .">">

<input name="location_latitude_g" id="location_latitude_g" value="<mt:var name="location_latitude_g">" />
<input name="location_longitude_g" id="location_longitude_g" value="<mt:var name="location_longitude_g">" />

<div id="location_map" class="full-width" style="height: 500px"></div>

<script
	src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=<MTGoogleMapAPIKey/>"	type="text/javascript"
>
</script>

<script
	src="http://www.google.com/uds/api?file=uds.js&v=1.0&key=<MTGoogleMapAPIKey/>"
	type="text/javascript"
></script>
<script
	src="http://www.google.com/uds/solutions/localsearch/gmlocalsearch.js"
	type="text/javascript"
></script>

<style type="text/css">
@import url("http://www.google.com/uds/css/gsearch.css");
@import url("http://www.google.com/uds/solutions/localsearch/gmlocalsearch.css");
</style>
<script type="text/javascript">
//<![CDATA[

if (GBrowserIsCompatible()) {
	(function() {
		var mobj = null;
		var map = null;
		new GMap2(document.getElementById("location_map"));

		function updateShopPoint(point, not_open) {
			if (mobj) {
				map.removeOverlay(mobj);
			}

			mobj = new GMarker(point);
			map.addOverlay(mobj);
			/*
			GEvent.addListener(mobj, "click", function() {
				map_regist_form = initMapRegistForm(point);
				mobj.openInfoWindow(map_regist_form);
				return false;
			});
			map_regist_form = initMapRegistForm(point);
			if (! not_open) {
				mobj.openInfoWindow(map_regist_form);
			}
			*/
		}

		map = new GMap2(document.getElementById("location_map"));

		map.addControl(new GLargeMapControl());

		var default_point = new GLatLng(<MT_TRANS phrase="Location default latitude">,<MT_TRANS phrase="Location default longitude">);
		map.setCenter(default_point, <MT_TRANS phrase="Location default zoomlevel">);
		updateShopPoint(default_point);

		var options = {
			//resultList : document.getElementById("location_results"),
			//searchFormHint : "Example Searches: Hotels in New York City"
		};
		// create a local search control and add it to your map
		var lsc = new google.maps.LocalSearch(options); 
		map.addControl(lsc);

//		lsc.searchForm.input.value = '佐久市岩村田';
//		lsc.searchForm.searchButton.click();
		GEvent.addListener(map, "click", function(marker, point) {
			if (! marker) {
				updateShopPoint(point)
			}
		});

	})();
}
//]]>
</script>
</mtapp:setting>

</fieldset>
